(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))h(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&h(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function h(o){if(o.ep)return;o.ep=!0;const r=i(o);fetch(o.href,r)}})();class ${constructor({x:e,y:i,type:h}){this.type=h,this.position={x:e,y:i},this.size=15}draw(){s.save(),s.translate(this.position.x,this.position.y),s.rotate(45*Math.PI/180),s.fillStyle="lightblue",s.fillRect(0,0,this.size,this.size),s.restore()}update(){}}class z{constructor({centerX:e,centerY:i}){this.position={centerX:e,centerY:i},this.speed=Math.round(Math.random()*20)/10,this.angle=Math.round(Math.random()*360),this.color=Math.round(Math.random()*20+30),this.currentColor="#ffffff00",this.radius=Math.round(Math.random()*50)/10,this.opacity=1}update(){this.speed>.2&&(this.speed=(this.speed*40-1)/40),this.position.centerX+=this.speed*Math.cos(this.angle),this.position.centerY+=this.speed*Math.sin(this.angle),this.currentColor=`rgba(${this.color},${this.color},
      ${this.color},1)`,s.beginPath(),s.arc(this.position.centerX,this.position.centerY,this.radius,0,2*Math.PI,!1),s.fillStyle=this.currentColor,s.fill()}}const v="/assets/smoke1.png",L="/assets/smoke2.png",W="/assets/smoke3.png",k=new Image;k.src=v;const P=new Image;P.src=L;const D=new Image;D.src=W;const X=[k,P,D];class Y{constructor({x:e,y:i,size:h}){this.position={x:e,y:i},this.angle=Math.floor(Math.random()*180-90),this.rotateSpeed=Math.round(Math.random()*4-2),this.sprite=X[Math.floor(Math.random()*3)],this.size=h,this.maxSize=h*2.5,this.minSize=h/2.5,this.isMaxSizes=!1}update(){this.angle+=this.rotateSpeed/100,this.size>=this.maxSize&&(this.isMaxSizes=!0),this.size<=this.maxSize&&!this.isMaxSizes?this.size=(this.size*10+5)/10:this.isMaxSizes&&this.size>=this.minSize/10&&(this.size=(this.size*10-10)/10),s.save(),s.translate(this.position.x,this.position.y),s.rotate(this.angle),s.drawImage(this.sprite,-this.size/2,-this.size/2,this.size,this.size),s.restore()}}const N="/assets/missile3.png",A=new Image;A.src=N;class O{constructor({x:e,y:i,width:h,height:o,angle:r,speed:c,minSpeed:g,ownerId:u}){this.position={x:e,y:i},this.vector={x:0,y:0},this.type="gm",this.speed=c,this.startSpeed=c,this.minSpeed=g,this.size={width:h,height:o},this.collision={r:(this.size.width+this.size.height)/4-this.size.width/10},this.rotationSpeed=.02,this.angle=r||0,this.sprite=A,this.smoking={currentFrame:0,smoke:10},this.ownerId=u,this.target=p.find(y=>y.id!==u),this.ownerPhysics=!1,this.frame=0}updateVector(){this.target?(this.vector.x=this.target.position.x-this.position.x,this.vector.y=this.target.position.y-this.position.y):(this.vector.y=-this.position.y,this.vector.x=-this.position.x)}angleCalibrate(){if(this.ownerPhysics&&this.speed>=this.minSpeed*3){let i=Math.atan2(this.vector.y,this.vector.x)-this.angle;i<-Math.PI?i+=Math.PI*2:i>Math.PI&&(i-=Math.PI*2),i<0?this.angle-=this.rotationSpeed:this.angle+=this.rotationSpeed}}speedUp(){this.ownerPhysics?this.speed<5&&(this.speed=(this.speed*20+1)/20):(this.speed=(this.speed*20-2)/20,this.speed<=this.minSpeed&&(this.ownerPhysics=!0))}smoke(){this.smoking.currentFrame>=this.smoking.smoke?(this.smoking.currentFrame=0,w.push(new Y({x:this.position.x,y:this.position.y,size:15})),w.length>=40&&w.shift()):this.smoking.currentFrame++}draw(){this.smoke(),this.speedUp(),this.updateVector(),this.angleCalibrate(),this.position.x+=this.speed*Math.cos(this.angle),this.position.y+=this.speed*Math.sin(this.angle),s.save(),s.translate(this.position.x,this.position.y),s.rotate(this.angle),s.drawImage(this.sprite,-this.size.width/2,-this.size.height/2,this.size.width,this.size.height),s.restore()}update(){}}const E="/assets/m2.png",q=new Image;q.src=E;const B=new Image;B.src=E;class F{constructor({centerX:e,centerY:i,radius:h,colorNumbers:o}){this.position={centerX:e,centerY:i},this.colorNumbers=o,this.color="#000000",this.radius=h,this.opacity=.6}update(e){this.opacity=(this.opacity*80-1)/80,(this.opacity*40-1)/40>.1&&(this.radius=(this.radius*40-1)/40),this.color=`rgba(${this.colorNumbers[0]},${this.colorNumbers[1]},
      ${this.colorNumbers[2]},${this.opacity})`,e.beginPath(),e.arc(this.position.centerX,this.position.centerY,this.radius,0,2*Math.PI,!1),e.fillStyle=this.color,e.fill()}}const C=new Image;C.src="/assets/planeB.png";class M{constructor({x:e,y:i,width:h,height:o,angle:r,keys:c,id:g}){this.id=g,this.position={x:e,y:i},this.size={width:h,height:o},this.cd={cd:6,currentCd:0},this.collision={r:(this.size.width+this.size.height)/4},this.speed=4,this.defaultSpeed=this.speed,this.sprite=C,this.rotation={angle:r*Math.PI/180,rotationSpeed:0},this.keys=c}shoot(){f.push(new O({x:this.position.x,y:this.position.y,width:25,height:40,speed:4,minSpeed:1,angle:this.rotation.angle,ownerId:this.id}))}tracing(){S.push(new F({centerX:this.position.x,centerY:this.position.y,colorNumbers:[100,100,100],radius:4})),S.length>=80&&S.shift()}draw(e){e.save(),e.translate(this.position.x,this.position.y),e.rotate(this.rotation.angle),e.drawImage(this.sprite,-this.size.width/2,-this.size.height/2,this.size.width,this.size.height),e.restore()}update(e){this.rotation.angle+=this.rotation.rotationSpeed/100,this.rotation.angle*180/Math.PI>360&&(this.rotation.angle-=2*Math.PI),this.rotation.angle*180/Math.PI<-360&&(this.rotation.angle+=2*Math.PI),this.position.x+=this.speed*Math.cos(this.rotation.angle),this.position.y+=this.speed*Math.sin(this.rotation.angle),this.draw(e),this.tracing()}}class l{constructor({x:e,y:i,width:h,height:o,color:r}){this.position={x:e,y:i},this.size={width:h,height:o},this.color=r}draw(){s.save(),s.translate(this.position.x,this.position.y),s.fillStyle=this.color,s.fillRect(0,0,this.size.width,this.size.height),s.restore()}}const a=document.getElementById("canvas");a.width=1603;a.height=733;const s=a.getContext("2d"),T=[[new l({x:a.width/2-190,y:10,width:400,height:20,color:"grey"}),new l({x:a.width/2-190,y:a.height-30,width:400,height:20,color:"grey"}),new l({x:a.width/2-120,y:30,width:20,height:200,color:"grey"}),new l({x:a.width/2+120,y:a.height-230,width:20,height:200,color:"grey"})]],U=T[0],S=[],f=[],w=[],m=[],p=[new M({x:1200,y:500,width:35,height:35,angle:-90,keys:"WASD",id:1}),new M({x:250,y:200,width:35,height:35,angle:90,keys:"ARROWS",id:2})],R=[...U,new l({x:0,y:0,width:a.width,height:10,color:"grey"}),new l({x:0,y:a.height-10,width:a.width,height:10,color:"grey"}),new l({x:0,y:10,width:10,height:a.height-20,color:"grey"}),new l({x:a.width-10,y:10,width:10,height:a.height-20,color:"grey"})],V={x:240,y:500,width:100,height:100},G={x:100,y:500,width:100,height:100};function I(t,e){s.beginPath(),s.rect(t.x,t.y,t.width,t.height),s.fillStyle="rgba(225,225,225,0.5)",s.fill(),s.lineWidth=2,s.strokeStyle="#000000",s.stroke(),s.closePath(),s.font="40pt Kremlin Pro Web",s.fillStyle="#000000",s.fillText(e,t.x+t.width/4,t.y+64)}const H=(t,e,i,h,o,r)=>(t-h)*(t-h)+(e-o)*(e-o)<=(i+r)*(i+r);function b(t,e,i,h,o,r,c){const g=Math.abs(t-h-r/2),u=Math.abs(e-o-c/2),y=r/2,x=c/2;return g>y+i||u>x+i?!1:g<=y||u<=x?!0:Math.pow(g-y,2)+Math.pow(u-x,2)<=Math.pow(i,2)}const j=()=>{f.forEach((t,e)=>{//! missile with Player
p.forEach((i,h)=>{if((t.ownerPhysics||!t.ownerPhysics&&t.ownerId!==i.id)&&H(i.position.x,i.position.y,i.collision.r,t.position.x,t.position.y,t.collision.r)){p.splice(h,1),f.splice(e,1);let o=[],r=450;for(let c=0;c<r;c++)o.push(new z({centerX:t.position.x+t.size.width/2,centerY:t.position.y+t.size.height/2,radius:4}));m.push(o)}})}),R.forEach((t,e)=>{//! wall with Player
p.forEach((i,h)=>{b(i.position.x,i.position.y,i.collision.r,t.position.x,t.position.y,t.size.width,t.size.height)&&p.splice(h,1)}),f.forEach((i,h)=>{if(b(i.position.x,i.position.y,i.collision.r,t.position.x,t.position.y,t.size.width,t.size.height)){f.splice(h,1);let o=[],r=450;for(let c=0;c<r;c++)o.push(new z({centerX:i.position.x+i.size.width/2,centerY:i.position.y+i.size.height/2,radius:4}));m.push(o),console.log("burst")}})})};setInterval(()=>{p.forEach(t=>{t.cd.currentCd>0&&(t.cd.currentCd-=6)}),f.forEach(t=>{t.physicsDelay&&(t.type==="gm"&&t.frame++,t.physicsDelay--,t.physicsDelay<=0&&(t.ownerPhysics=!0))})},1e3);const J=new $({x:800,y:400,type:"gm"}),K=()=>{requestAnimationFrame(K),s.clearRect(0,0,a.width,a.height),s.fillStyle="#4D4D4D",s.fillRect(0,0,a.width,a.height),j(),J.draw(),S.forEach(t=>t.update(s)),m.forEach((t,e)=>{m.length===0&&m.splice(e,1),t.forEach((i,h)=>{i.speed<=.2?t.splice(h,1):i.update()})}),w.forEach((t,e)=>{t.minSize>=t.size&&w.splice(e,1),t.update()}),p.forEach(t=>t.update(s)),f.forEach((t,e)=>{t.draw()}),R.forEach(t=>t.draw()),I(V,">"),I(G,"<")};K();const n=p.find(t=>t.keys==="WASD"),d=p.find(t=>t.keys==="ARROWS");window.addEventListener("keydown",t=>{switch(t.code){case"KeyA":n.rotation.rotationSpeed=-4;break;case"KeyD":n.rotation.rotationSpeed=4;break;case"KeyS":n.speed=n.defaultSpeed/1.5;break;case"KeyE":n.cd.currentCd===0&&(n.cd.currentCd=n.cd.cd,n.shoot());break;case"ArrowLeft":d.rotation.rotationSpeed=-4;break;case"ArrowRight":d.rotation.rotationSpeed=4;break;case"ArrowDown":d.speed=d.defaultSpeed/1.5;break;case"Slash":d.cd.currentCd===0&&(d.cd.currentCd=n.cd.cd,d.shoot());break}});window.addEventListener("keyup",t=>{t.code==="KeyS"?n.speed=n.defaultSpeed:t.code==="ArrowDown"?d.speed=d.defaultSpeed:t.code==="KeyA"&&n.rotation.rotationSpeed<0||t.code==="KeyD"&&n.rotation.rotationSpeed>0||t.code==="KeyA"&&n.rotation.rotationSpeed<0||t.code==="KeyD"&&n.rotation.rotationSpeed>0?n.rotation.rotationSpeed=0:(t.code==="ArrowLeft"&&d.rotation.rotationSpeed<0||t.code==="ArrowRight"&&d.rotation.rotationSpeed>0||t.code==="ArrowLeft"&&d.rotation.rotationSpeed<0||t.code==="ArrowRight"&&d.rotation.rotationSpeed>0)&&(d.rotation.rotationSpeed=0)});